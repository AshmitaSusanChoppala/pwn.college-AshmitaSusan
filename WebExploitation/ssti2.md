# Web Exploitation

## SSTI2
I made a cool website where you can announce whatever you want! I read about input sanitization, so now I remove any kind of characters that could be a problem :)
I heard templating is a cool and modular way to build web apps! Check out my website here!

### Solve
**Flag:** `picoCTF{sst1_f1lt3r_byp4ss_a9824e27}`

Given is a website "http://shape-facility.picoctf.net:57878/" which asks us if we want to announce anything. Upon executing some commands with curly braces, it is found out that the website is vulnerable to server side template injection. To find out which template the website is using, " curl -i http://shape-facility.picoctf.net:57878/" command was run in bash and it was found out that it is using python. I used jinja2 as the template engine to be exploited since we use python. I searched online for some payload for remote command execution which gave "{{request.application.__globals__.__builtins__.__import__('os').popen('id').read()}}" for executing the command id. After executing this in the website it gave the notice "Stop trying to break me >:(". As given in the challenge description, we have to decode the characters in the payload. After giving this"{{request|attr('application')|attr('\x5f\x5fglobals\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fbuiltins\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fimport\x5f\x5f')('os')|attr('popen')('id')|attr('read')()}}" as the payload for the ls command execution, we got the list of directories as: __pycache__ app.py flag requirements.txt. We got our flag file, so the flag was read using the "cat flag" command in our payload which gave the flag as the output.

### New Learnings
-> Using server side template injection.

### References
https://portswigger.net/web-security/server-side-template-injection 
https://www.youtube.com/watch?v=QLqHMMcBXuQ&list=PL1GDzLoRwyVCEG_dnWcQDbDXJSBw7lTOT&index=1
https://www.yeswehack.com/learn-bug-bounty/server-side-template-injection-exploitation
https://onsecurity.io/article/server-side-template-injection-with-jinja2/